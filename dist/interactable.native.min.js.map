{"version":3,"file":"interactable.native.min.js","sources":["../playground/src/react-interactable/Utils.js","../playground/src/react-interactable/Behaviors.js","../playground/src/react-interactable/InteractableView.js","../playground/src/react-interactable/Animator.js","../playground/src/react-interactable/native.js"],"sourcesContent":["export default {\r\n\tcreateArea: function( boundaries ){\r\n\t\treturn {\r\n\t\t\tminPoint: {\r\n\t\t\t\tx: boundaries.left === undefined ? -Infinity : boundaries.left,\r\n\t\t\t\ty: boundaries.top === undefined ? -Infinity : boundaries.top\r\n\t\t\t},\r\n\t\t\tmaxPoint: {\r\n\t\t\t\tx: boundaries.right === undefined ? Infinity : boundaries.right,\r\n\t\t\t\ty: boundaries.bottom === undefined ? Infinity : boundaries.bottom\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tcreateAreaFromRadius: function( radius, anchor ){\r\n\t\treturn {\r\n\t\t\tminPoint: {x: anchor.x - radius, y: anchor.y - radius},\r\n\t\t\tmaxPoint: {x: anchor.x + radius, y: anchor.y + radius}\r\n\t\t}\r\n\t},\r\n\tisPointInArea: function( {x, y}, area ){\r\n\t\tif( !area ) return true\r\n\r\n\t\tlet { minPoint, maxPoint } = area\r\n\r\n\t\treturn x>=minPoint.x && x <= maxPoint.x && y >= minPoint.y && y <= maxPoint.y\r\n\t},\r\n\tfindClosest: function( origin, points ){\r\n\t\tlet minDistance = Infinity;\r\n\t\tlet closestPoint = null;\r\n\t\tlet distances = []\r\n\t\tpoints.forEach( point => {\r\n\t\t\tlet distance = this.getDistance( point, origin );\r\n\t\t\tdistances.push( distance )\r\n\t\t\tif (distance < minDistance) {\r\n\t\t\t\tminDistance = distance;\r\n\t\t\t\tclosestPoint = point;\r\n\t\t\t}\r\n\t\t})\r\n\t\t// console.log( distances )\r\n\t\treturn closestPoint\r\n\t},\r\n\tgetDistance( point, relative ){\r\n\t\tlet p = {x: point.x === undefined ? Infinity : point.x, y: point.y === undefined ? Infinity : point.y }\r\n\t\tlet r = {x: relative.x === undefined ? Infinity : relative.x, y: relative.y === undefined ? Infinity : relative.y }\r\n\t\tif( p.x === Infinity && p.y === Infinity ) return Infinity\r\n\t\tlet dx = p.x === Infinity ? 0 : Math.abs(r.x - p.x)\r\n\t\tlet dy = p.y === Infinity ? 0 : Math.abs(r.y - p.y)\r\n\t\t\r\n\t\treturn Math.sqrt( dx*dx + dy*dy )\r\n\t},\r\n\tgetDelta( point, origin ){\r\n\t\treturn {\r\n\t\t\tx: point.x - origin.x,\r\n\t\t\ty: point.y - origin.y\r\n\t\t}\r\n\t}\r\n}","import Utils from './Utils'\r\n\r\nfunction def( value, defaultValue ){\r\n\treturn value === undefined ? defaultValue : value\r\n}\r\n\r\nexport default {\r\n\tanchor: {\r\n\t\tcreate: (options, isTemp = false) => (\r\n\t\t\t{ x0: options.x, y0: options.y, priority: 1, isTemp, type: 'anchor' }\r\n\t\t),\r\n\t\tdoFrame: (options, deltaTime, state, coords ) => {\r\n\t\t\t// Velocity = dx / deltaTime\r\n\t\t\tstate.vx = (options.x0 - coords.x) / deltaTime\r\n\t\t\tstate.vy = (options.y0 - coords.y) / deltaTime\r\n\t\t}\r\n\t},\r\n\r\n\tbounce: {\r\n\t\tcreate: (options, isTemp = false) => ({\r\n\t\t\ttype: 'bounce',\r\n\t\t\tbounce: def(options.bounce, .5),\r\n\t\t\tminPoint: options.influence.minPoint,\r\n\t\t\tmaxPoint: options.influence.maxPoint,\r\n\t\t\tpriority: 3,\r\n\t\t\tisTemp\r\n\t\t}),\r\n\t\tdoFrame: ({minPoint, maxPoint, bounce}, deltaTime, state, {x,y}, target ) => {\r\n\t\t\t// Apply limits\r\n\r\n\t\t\tif (minPoint.x > x) target.setTranslationX(minPoint.x);\r\n\t\t\tif (minPoint.y > y) target.setTranslationY(minPoint.y);\r\n\t\t\tif (maxPoint.x < x) target.setTranslationX(maxPoint.x);\r\n\t\t\tif (maxPoint.y < y) target.setTranslationY(maxPoint.y);\r\n\r\n\t\t\tlet { vx, vy } = state\r\n\r\n\t\t\tif (minPoint.x > x && vx < 0) {\r\n\t\t\t\tstate.vx = -vx * bounce\r\n\t\t\t}\r\n\t\t\tif (minPoint.y > y && vy < 0) {\r\n\t\t\t\tstate.vy= -vy * bounce\r\n\t\t\t}\r\n\t\t\tif (maxPoint.x < x && vx > 0) {\r\n\t\t\t\tstate.vx = -vx * bounce\r\n\t\t\t}\r\n\t\t\tif (maxPoint.y < y && vy > 0) {\r\n\t\t\t\tstate.vy = -vy * bounce\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tfriction: {\r\n\t\tcreate: ( options, isTemp = false ) => ({\r\n\t\t\ttype: 'friction',\r\n\t\t\tdamping: def(options.damping, .7),\r\n\t\t\tinfluence: Utils.createArea( options.influenceArea || {} ),\r\n\t\t\tpriority: 2,\r\n\t\t\tisTemp\r\n\t\t}),\r\n\t\tdoFrame: (options, deltaTime, state, coords) => {\r\n\t\t\tif( !Utils.isPointInArea( coords, options.influence) ) return;\r\n\t\t\t\r\n\t\t\tlet pow = Math.pow(options.damping, 60.0 * deltaTime)\r\n\t\t\tstate.vx = pow * state.vx\r\n\t\t\tstate.vy = pow * state.vy\r\n\t\t}\r\n\t},\r\n\r\n\tgravity: {\r\n\t\tcreate: ( options, isTemp = false ) => ({\r\n\t\t\ttype: 'gravity',\r\n\t\t\tx0: def(options.x, Infinity),\r\n\t\t\ty0: def(options.y, Infinity),\r\n\t\t\tstrength: def(options.strength, 400),\r\n\t\t\tfalloff: def(options.falloff, 40),\r\n\t\t\tdamping: def(options.damping, 0),\r\n\t\t\tinfluence: Utils.createArea(options.influenceArea || {}),\r\n\t\t\tisTemp,\r\n\t\t\tpriority: 1\r\n\t\t}),\r\n\t\tdoFrame: (options, deltaTime, state, coords) => {\r\n\t\t\tif( !Utils.isPointInArea( coords, options.influence) ) return;\r\n\r\n\t\t\tlet dx = options.x0 !== Infinity ? coords.x - options.x0 : 0;\r\n\t\t\tlet dy = options.y0 !== Infinity ? coords.y - options.y0 : 0;\r\n\t\t\tlet dr = Math.sqrt(dx * dx + dy * dy);\r\n\r\n\t\t\tif (!dr) return;\r\n\r\n\t\t\tlet { falloff, strength } = options\r\n\t\t\tlet a = (-strength * dr * Math.exp(-0.5 * (dr * dr) / (falloff * falloff))) / state.mass;\r\n\r\n\t\t\tlet ax = dx / dr * a;\r\n\t\t\tlet ay = dy / dr * a;\r\n\r\n\t\t\tstate.vx += deltaTime * ax\r\n\t\t\tstate.vy += deltaTime * ay\r\n\t\t}\r\n\t},\r\n\r\n\tspring: {\r\n\t\tcreate: ( options, isTemp = false ) => ({\r\n\t\t\ttype: 'spring',\r\n\t\t\tx0: def(options.x, 0),\r\n\t\t\ty0: def(options.y, 0),\r\n\t\t\ttension: def(options.tension, 300),\r\n\t\t\tinfluence: Utils.createArea( options.influenceArea || {} ),\r\n\t\t\tisTemp,\r\n\t\t\tpriority: 1\r\n\t\t}),\r\n\t\tdoFrame: ( options, deltaTime, state, coords) => {\r\n\t\t\tif( !Utils.isPointInArea( coords, options.influence) ) return;\r\n\t\r\n\t\t\tlet dx = coords.x - options.x0;\r\n\t\t\tif( dx ){\r\n\t\t\t\t// time * acceleration\r\n\t\t\t\tstate.vx += deltaTime * ((-1 * options.tension * dx) / state.mass)\r\n\t\t\t}\r\n\t\r\n\t\t\tlet dy = coords.y - options.y0;\r\n\t\t\tif( dy ){\r\n\t\t\t\t// time * acceleration\r\n\t\t\t\tstate.vy += deltaTime * ((-1 * options.tension * dy) / state.mass)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","import React, { Component } from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport Animator from './Animator'\r\nimport Utils from './Utils';\r\n\r\nconst propBehaviors = {\r\n\tfrictionAreas: 'friction',\r\n\tgravityPoints: 'gravity',\r\n\tspringPoints: 'spring',\r\n}\r\n\r\nconst isWeb = typeof document !== 'undefined'\r\n\r\nexport default function injectDependencies( Animated, PanResponder ){\r\n\r\n\treturn class InteractableView extends Component {\r\n\t\tstatic propTypes = {\r\n\t\t\tsnapPoints: PropTypes.array,\r\n\t\t\tfrictionAreas: PropTypes.array,\r\n\t\t\talertAreas: PropTypes.array,\r\n\t\t\tgravityPoints: PropTypes.array,\r\n\t\t\thorizontalOnly: PropTypes.bool,\r\n\t\t\tverticalOnly: PropTypes.bool,\r\n\t\t\tdragWithSpring: PropTypes.object,\r\n\t\t\tdragEnabled: PropTypes.bool,\r\n\t\t\tanimatedValueX: PropTypes.instanceOf(Animated.Value),\r\n\t\t\tanimatedValueY: PropTypes.instanceOf(Animated.Value),\r\n\t\t\tonSnap: PropTypes.func,\r\n\t\t\tonSnapStart: PropTypes.func,\r\n\t\t\tonEnd: PropTypes.func,\r\n\t\t\tonDrag: PropTypes.func,\r\n\t\t\tboundaries: PropTypes.object,\r\n\t\t\tinitialPosition: PropTypes.object,\r\n\t\t\tdragToss: PropTypes.number\r\n\t\t}\r\n\r\n\t\tstatic defaultProps = {\r\n\t\t\tsnapPoints: [],\r\n\t\t\tfrictionAreas: [],\r\n\t\t\talertAreas: [],\r\n\t\t\tgravityPoints: [],\r\n\t\t\tboundaries: {},\r\n\t\t\tinitialPosition: {x: 0, y: 0},\r\n\t\t\tdragToss: .1,\r\n\t\t\tdragEnabled: true,\r\n\t\t\tonSnap: function () { },\r\n\t\t\tonSnapStart: function () { },\r\n\t\t\tonStop: function () { },\r\n\t\t\tonDrag: function () { },\r\n\t\t\tonAlert: function () { },\r\n\t\t\tstyle: {}\r\n\t\t}\r\n\r\n\t\tinitialPositionSet = false\r\n\t\tisDragging = false\r\n\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props)\r\n\r\n\t\t\tlet { x=0, y=0 } = props.initialPosition\r\n\r\n\t\t\t// In case animatedValueXY is not given\r\n\t\t\tthis.animated = new Animated.ValueXY({x, y})\r\n\r\n\t\t\t// This guy will apply all the physics\r\n\t\t\tthis.animator = this.createAnimator( props )\r\n\r\n\t\t\t// Cache when the view is inside of an alert area\r\n\t\t\tthis.insideAlertAreas = {}\r\n\r\n\t\t\t// cache calculated areas\r\n\t\t\tthis.propAreas = {\r\n\t\t\t\talert: [],\r\n\t\t\t\tboundaries: false\r\n\t\t\t}\r\n\r\n\t\t\tthis._pr = this.createPanResponder(props)\r\n\t\t\t\r\n\t\t\t// Set behaviors and prop defaults\r\n\t\t\tthis.setPropBehaviours( {}, props )\r\n\r\n\t\t\t// Set initial position\r\n\t\t\tlet animated  = this.getAnimated( props )\r\n\t\t\tanimated.x.setValue( x )\r\n\t\t\tanimated.y.setValue(y)\r\n\t\t\tanimated.x._startingValue = x\r\n\t\t\tanimated.y._startingValue = y\r\n\t\t\t\r\n\t\t\t// Save the last animation end position to report good coordinates in the events\r\n\t\t\tthis.lastEnd = {...this.initialPosition}\r\n\t\t}\r\n\r\n\t\trender() {\r\n\t\t\tlet { x, y } = this.getAnimated()\r\n\t\t\tlet style = this.props.style\r\n\t\t\tlet withPosition = {\r\n\t\t\t\ttransform: [{ translateX: x }, { translateY: y }].concat( style.transform || [] ),\r\n\t\t\t\t...style\r\n\t\t\t}\r\n\r\n\t\t\tlet panHandlers = this.props.dragEnabled ? this._pr.panHandlers : {}\r\n\r\n\t\t\treturn (\r\n\t\t\t\t<Animated.View style={withPosition} {...panHandlers}>\r\n\t\t\t\t\t{this.props.children}\r\n\t\t\t\t</Animated.View>\r\n\t\t\t)\r\n\t\t}\r\n\r\n\t\tgetTranslation(){\r\n\t\t\tlet {x, y} = this.getAnimated()\r\n\t\t\treturn {\r\n\t\t\t\tx: x._value + x._offset,\r\n\t\t\t\ty: y._value + y._offset\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tsetTranslationX( tx ){\r\n\t\t\tlet animated = this.props.animatedValueX || this.animated.x\r\n\t\t\tanimated.setValue( tx - animated._offset )\r\n\t\t}\r\n\r\n\t\tsetTranslationY(ty) {\r\n\t\t\tlet animated = this.props.animatedValueY || this.animated.y\r\n\t\t\tanimated.setValue( ty - animated._offset )\r\n\t\t}\r\n\r\n\t\tsetTranslation( tx, ty ){\r\n\t\t\tthis.setTranslationX( tx )\r\n\t\t\tthis.setTranslationY( ty )\r\n\t\t}\r\n\r\n\t\tcreateAnimator(){\r\n\t\t\treturn new Animator( this, {\r\n\t\t\t\tonAnimatorPause: () => {\r\n\t\t\t\t\tlet { x, y } = this.getTranslation()\r\n\t\t\t\t\tthis.lastEnd = {x: Math.round(x), y: Math.round(y)}\r\n\t\t\t\t\tthis.props.onStop( this.lastEnd )\r\n\t\t\t\t},\r\n\t\t\t\tonAnimationFrame: () => {\r\n\t\t\t\t\tthis.reportAlertEvent( this.getTranslation() )\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tfalse // Set true or behavior type to output debug info in the console\r\n\t\t\t)\r\n\t\t}\r\n\r\n\t\tanimate( dx, dy ){\r\n\t\t\tif(!dx && !dy) return\r\n\t\t\t// let animated = this.getAnimated()\r\n\t\t\t// console.log( dx + animated.x._value + animated.x._offset )\r\n\r\n\t\t\tlet {x,y}  = this.getTranslation()\r\n\t\t\tthis.setTranslation( x + dx, y + dy ) \r\n\t\t}\r\n\r\n\t\tgetAnimated( props ){\r\n\t\t\tlet { animatedValueX, animatedValueY } = (props || this.props)\r\n\r\n\t\t\treturn {\r\n\t\t\t\tx: animatedValueX || this.animated.x ,\r\n\t\t\t\ty: animatedValueY || this.animated.y\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tcreatePanResponder() {\r\n\t\t\treturn PanResponder.create({\r\n\t\t\t\tonMoveShouldSetResponderCapture: () => true,\r\n\t\t\t\tonMoveShouldSetPanResponderCapture: () => true,\r\n\r\n\t\t\t\tonPanResponderGrant: (e, {x0, y0}) => {\t\r\n\t\t\t\t\tthis.startDrag( {x: x0, y: y0} )\r\n\t\t\t\t},\r\n\r\n\t\t\t\tonPanResponderMove: (evt, gesture ) => {\r\n\t\t\t\t\tthis.onDragging( gesture )\r\n\t\t\t\t},\r\n\r\n\t\t\t\tonPanResponderRelease: () => {\r\n\t\t\t\t\tthis.endDrag()\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\treportAlertEvent( position ){\r\n\t\t\tlet inside = this.insideAlertAreas\r\n\t\t\tlet { onAlert } = this.props\r\n\r\n\t\t\tthis.propAreas.alert.forEach( ({ influence, id }) => {\r\n\t\t\t\tif ( !influence || !id ) return;\r\n\r\n\t\t\t\tif ( Utils.isPointInArea( position, influence ) ) {\r\n\t\t\t\t\tif ( !inside[id] ) {\r\n\t\t\t\t\t\tonAlert({id, value:\"enter\"});\r\n\t\t\t\t\t\tinside[id] = 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (inside[id]) {\r\n\t\t\t\t\tonAlert({ id, value: \"leave\" });\r\n\t\t\t\t\tinside[id] = 0;\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tstartDrag( ev ){\r\n\t\t\t// Prepare the animated\r\n\t\t\tlet {x,y} = this.getAnimated()\r\n\t\t\tlet offset = {x: x._value, y: y._value}\r\n\t\t\tx.setOffset( offset.x )\r\n\t\t\ty.setOffset( offset.y )\r\n\t\t\tx.setValue( 0 )\r\n\t\t\ty.setValue( 0 )\r\n\r\n\t\t\t// Save the offset for triggering events with the right coordinates\r\n\t\t\tthis.lastEnd = offset\r\n\t\t\t// console.log( offset )\r\n\r\n\t\t\t// Set boundaries to fast access\r\n\t\t\tthis.dragBoundaries = this.propAreas.boundaries ? this.propAreas.boundaries.influence : {}\r\n\r\n\t\t\t// Prepare the animation\r\n\t\t\tthis.props.onDrag({state: 'start', x: offset.x, y: offset.y})\r\n\t\t\tthis.dragStartLocation = { x: ev.x, y: ev.y }\r\n\t\t\tthis.animator.removeTempBehaviors();\r\n\t\t\tthis.animator.isDragging = true\r\n\t\t\tthis.animator.vx = 0\r\n\t\t\tthis.animator.vy = 0\r\n\t\t\tthis.addTempDragBehavior( this.props.dragWithSpring );\r\n\r\n\t\t\t// Stop text selection\r\n\t\t\tif ( isWeb ) {\r\n\t\t\t\tlet styles = document.body.style\r\n\t\t\t\tthis.userSelectCache = styles.userSelect\r\n\t\t\t\tstyles.userSelect = \"none\"\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tonDragging({dx, dy}){\r\n\t\t\tif( !this.animator.isDragging ) return false\r\n\t\t\tif( !this.props.dragEnabled ) return this.endDrag()\r\n\r\n\t\t\tlet pos = this.lastEnd\r\n\t\t\tlet x = dx + pos.x\r\n\t\t\tlet y = dy + pos.y\r\n\t\t\t\r\n\t\t\t// console.log( this.dragBoundaries.minPoint )\r\n\r\n\t\t\tlet {minPoint, maxPoint} = this.dragBoundaries\r\n\t\t\tif( !this.props.verticalOnly ){\r\n\t\t\t\tif (minPoint) {\r\n\t\t\t\t\tif (minPoint.x > x) x = minPoint.x\r\n\t\t\t\t\tif (maxPoint.x < x) x = maxPoint.x\r\n\t\t\t\t}\r\n\t\t\t\tthis.dragBehavior.x0 = x\r\n\t\t\t}\r\n\r\n\t\t\tif (!this.props.horizontalOnly) {\r\n\t\t\t\tif (minPoint) {\r\n\t\t\t\t\tif (minPoint.y > y) y = minPoint.y\r\n\t\t\t\t\tif (maxPoint.y < y) y = maxPoint.y\r\n\t\t\t\t}\r\n\t\t\t\tthis.dragBehavior.y0 = y\r\n\t\t\t}\r\n\r\n\t\t\t// console.log( this.dragBehavior )\r\n\t\t}\r\n\r\n\t\tendDrag(){\r\n\t\t\tthis.animator.removeTempBehaviors();\r\n\t\t\tthis.dragBehavior = null;\r\n\t\t\tthis.animator.isDragging = false\r\n\r\n\t\t\tlet { animator, horizontalOnly, verticalOnly, dragWithSprings } = this\r\n\r\n\t\t\tlet velocity = animator.getVelocity();\r\n\t\t\tif (horizontalOnly) velocity.y = 0;\r\n\t\t\tif (verticalOnly) velocity.x = 0;\r\n\t\t\t\r\n\t\t\tlet toss = (dragWithSprings && dragWithSprings.toss) || this.props.dragToss;\r\n\t\t\tlet {x,y} = this.getTranslation()\r\n\t\t\tlet projectedCenter = {\r\n\t\t\t\tx: x + toss * velocity.x,\r\n\t\t\t\ty: y + toss * velocity.y\r\n\t\t\t};\r\n\r\n\t\t\t// console.log( 'pc', projectedCenter, velocity)\r\n\t\t\tlet snapPoint = Utils.findClosest(projectedCenter, this.props.snapPoints);\r\n\t\t\tlet targetSnapPointId = (snapPoint && snapPoint.id) || \"\";\r\n\r\n\t\t\tthis.props.onDrag({ state: 'end', x: x, y: y, targetSnapPointId })\r\n\r\n\t\t\tthis.addTempSnapToPointBehavior(snapPoint);\r\n\t\t\tthis.addTempBoundaries();\r\n\r\n\t\t\tlet animated = this.getAnimated()\r\n\t\t\tanimated.x.flattenOffset()\r\n\t\t\tanimated.y.flattenOffset()\r\n\r\n\t\t\t// Restore text selection\r\n\t\t\tif ( isWeb ) {\r\n\t\t\t\tdocument.body.userSelect = this.userSelectCache || ''\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\taddTempDragBehavior( drag ) {\r\n\t\t\tlet pos = this.getTranslation()\r\n\r\n\t\t\tif ( !drag || drag.tension === Infinity ) {\r\n\t\t\t\tthis.dragBehavior = this.animator.addBehavior( 'anchor', pos, true )\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tpos.tension = drag.tension || 300\r\n\t\t\t\tthis.dragBehavior = this.animator.addBehavior( 'spring', pos, true )\r\n\t\t\t\tif( drag.damping ){\r\n\t\t\t\t\tthis.animator.addBehavior('friction', drag, true)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\taddTempSnapToPointBehavior( snapPoint ) {\r\n\t\t\tif (!snapPoint)  return;\r\n\t\t\tlet { snapPoints, onSnap, onSnapStart } = this.props\r\n\r\n\t\t\tlet index = snapPoints.indexOf(snapPoint)\r\n\r\n\t\t\tonSnap({index, id: snapPoint.id});\r\n\t\t\tonSnapStart({index, id: snapPoint.id});\r\n\r\n\t\t\tlet springOptions = {\r\n\t\t\t\tdamping: .7,\r\n\t\t\t\ttension: 300,\r\n\t\t\t\t...snapPoint\r\n\t\t\t}\r\n\r\n\t\t\tthis.addBehavior( 'spring', springOptions, true )\r\n\t\t}\r\n\r\n\t\tsetVelocity( velocity ) {\r\n\t\t\tif ( this.dragBehavior ) return;\r\n\t\t\tthis.animator.physicsObject.vx = velocity.x\r\n\t\t\tthis.animator.physicsObject.vy = velocity.y\r\n\t\t\tthis.endDrag();\r\n\t\t}\r\n\r\n\t\tsnapTo( {index} ) {\r\n\t\t\tlet {snapPoints} = this.props;\r\n\r\n\t\t\tif( !snapPoints || index === undefined || index >= snapPoints.length ) return;\r\n\t\t\t\r\n\t\t\tthis.animator.removeTempBehaviors();\r\n\t\t\tthis.dragBehavior = null;\r\n\t\t\tlet snapPoint = snapPoints[index]\r\n\r\n\t\t\tthis.addTempSnapToPointBehavior(snapPoint);\r\n\t\t\tthis.addTempBoundaries();\r\n\t\t}\r\n\r\n\t\taddTempBoundaries(){\r\n\t\t\tlet boundaries = this.propAreas.boundaries;\r\n\t\t\tif( !boundaries ) return;\r\n\t\t\tthis.animator.addBehavior( 'bounce', boundaries, true );\r\n\t\t}\r\n\r\n\t\tchangePosition( position ) {\r\n\t\t\tif ( this.dragBehavior ) return;\r\n\r\n\t\t\tthis.setTranslation( position.x, position.y )\r\n\t\t\tthis.endDrag();\r\n\t\t}\r\n\r\n\t\tcomponentDidUpdate( prevProps ){\r\n\t\t\tthis.setPropBehaviours( prevProps, this.props )\r\n\t\t}\r\n\r\n\t\tsetPropBehaviours( prevProps, props ){\r\n\t\t\t// spring, gravity, friction\r\n\t\t\tObject.keys( propBehaviors ).forEach( prop => {\r\n\t\t\t\tif( prevProps[ prop ] !== props[ prop ] ){\r\n\t\t\t\t\tthis.animator.removeTypeBehaviors(propBehaviors[prop])\r\n\t\t\t\t\tthis.addTypeBehaviors( propBehaviors[prop], props[ prop ] )\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tif( prevProps.alertAreas !== props.alertAreas ){\r\n\t\t\t\tlet alertAreas = []\r\n\t\t\t\tprops.alertAreas.forEach( area => {\r\n\t\t\t\t\talertAreas.push({\r\n\t\t\t\t\t\tid: area.id,\r\n\t\t\t\t\t\tinfluence: Utils.createArea( area.influenceArea )\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t\tthis.propAreas.alert = alertAreas\r\n\t\t\t}\r\n\r\n\t\t\tif( prevProps.boundaries !== props.boundaries ){\r\n\t\t\t\tthis.animator.removeBehavior( this.oldBoundariesBehavior )\r\n\t\t\t\tif( props.boundaries ){\r\n\t\t\t\t\tlet bounce = {\r\n\t\t\t\t\t\tbounce: props.boundaries.bounce || 0,\r\n\t\t\t\t\t\tinfluence: Utils.createArea( props.boundaries )\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.propAreas.boundaries = bounce\r\n\t\t\t\t\tthis.oldBoundariesBehavior = this.animator.addBehavior( 'bounce', bounce )\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.propAreas.boundaries = false\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (!this.props.dragEnabled && prevProps.dragEnabled && this.dragBehavior ){\r\n\t\t\t\tthis.endDrag()\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\taddTypeBehaviors( type, behaviors, isTemp ){\r\n\t\t\tbehaviors.forEach( b => this.addBehavior( type, b, isTemp )\t)\r\n\t\t}\r\n\r\n\t\taddBehavior( type, behavior, isTemp ){\r\n\t\t\tthis.animator.addBehavior( type, behavior, isTemp )\r\n\t\t\tif( behavior.damping && type !== 'friction' ){\r\n\t\t\t\tlet b = this.animator.addBehavior('friction', behavior, isTemp )\r\n\t\t\t\tif( type === 'gravity' && !behavior.influenceArea ){\r\n\t\t\t\t\tb.influence = Utils.createAreaFromRadius(1.4 * (behavior.falloff || 40), behavior)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n","import Behaviors from './Behaviors'\r\n\r\nconst ANIMATOR_PAUSE_CONSECUTIVE_FRAMES = 10;\r\nconst ANIMATOR_PAUSE_ZERO_VELOCITY = 1.0;\r\n\r\nclass PhysicsAnimator {\r\n\tbehaviors = []\r\n\tphysicsObject = {vx: 0, vy: 0, mass: 1}\r\n\tconsecutiveFramesWithNoMovement = 0\r\n\tscreenScale = 1\r\n\tlastFrameTS = 0\r\n\tisRunning = false\r\n\tticking = false\r\n\tisDragging = false\r\n\r\n\tconstructor( View, listener, debug ){\r\n\t\tthis.View = View\r\n\t\tthis.animatorListener = listener\r\n\t\tif( !debug ){\r\n\t\t\tlet nofn = function(){}\r\n\t\t\tthis.debugStart = nofn;\r\n\t\t\tthis.debugEnd = nofn;\r\n\t\t}\r\n\t}\r\n\r\n\tdoFrame( frameTimeMillis ) {\r\n\t\tif( !this.isRunning ) return;\r\n\r\n\t\tif ( this.lastFrameTS ) {\r\n\t\t\tthis.animateFrameWithDeltaTime(\r\n\t\t\t\t(frameTimeMillis - this.lastFrameTS) * 1e-3\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tthis.lastFrameTS = frameTimeMillis;\r\n\t\tthis.animatorListener.onAnimationFrame();\r\n\t\trequestAnimationFrame( () => this.doFrame( Date.now() ) )\r\n\t}\r\n\r\n\tdebugStart( behavior ){\r\n\t\tif( this.debug !== true && this.debug !== behavior.type ) return;\r\n\t\tthis.debugB = behavior\r\n\t\tthis.debugInitialV = {...this.physicsObject}\r\n\t}\r\n\r\n\tdebugEnd() {\r\n\t\tif (!this.debugB || (this.debug !== true && this.debug !== this.debugB.type)) return;\r\n\t\tconsole.log( `Debug ${this.debugB.type}`, {\r\n\t\t\tdvx: this.physicsObject.vx - this.debugInitialV.vx,\r\n\t\t\tdvy: this.physicsObject.vy - this.debugInitialV.vy,\r\n\t\t})\r\n\t}\r\n\t\r\n\tanimateFrameWithDeltaTime( deltaTime ) {\r\n\t\tif( !deltaTime ) return;\r\n\r\n\t\tlet { physicsObject, behaviors, View } = this\r\n\t\tlet hadMovement = false\r\n\t\tlet coords = View.getTranslation()\r\n\r\n\t\tbehaviors.forEach( behavior => {\r\n\t\t\tthis.debugStart( behavior )\r\n\t\t\tBehaviors[ behavior.type ].doFrame( behavior, deltaTime, physicsObject, coords, View )\r\n\t\t\tthis.debugEnd()\r\n\t\t})\r\n\r\n\t\tlet dx = 0;\r\n\t\tlet {vx,vy} = physicsObject\r\n\t\t\r\n\t\tif ( Math.abs(vx) > ANIMATOR_PAUSE_ZERO_VELOCITY ) {\r\n\t\t\tdx = deltaTime * vx;\r\n\t\t\thadMovement = true;\r\n\t\t}\r\n\r\n\t\tlet dy = 0;\r\n\t\tif ( Math.abs(vy) > ANIMATOR_PAUSE_ZERO_VELOCITY ) {\r\n\t\t\tdy = deltaTime * vy;\r\n\t\t\thadMovement = true;\r\n\t\t}\r\n\t\t\r\n\t\tView.animate( dx, dy )\r\n\r\n\t\tlet cfwnm = hadMovement ? 0 : this.consecutiveFramesWithNoMovement + 1\r\n\t\tthis.consecutiveFramesWithNoMovement = cfwnm\r\n\r\n\t\tif (cfwnm >= ANIMATOR_PAUSE_CONSECUTIVE_FRAMES && !this.isDragging ) {\r\n\t\t\tthis.stopRunning();\r\n\t\t\tthis.animatorListener.onAnimatorPause();\r\n\t\t}\r\n\t}\r\n\r\n\taddBehavior( type, options, isTemp ){\r\n\t\tlet b = Behaviors[ type ]\r\n\t\tif( !b ) return;\r\n\r\n\t\tlet behavior = b.create( options, isTemp )\r\n\t\tlet behaviors = this.behaviors\r\n\t\tlet idx = 0\r\n\r\n\t\twhile (behaviors.length > idx && behaviors[idx].priority <= behavior.priority) {\r\n\t\t\t++idx;\r\n\t\t}\r\n\t\tbehaviors.splice( idx, 0, behavior )\r\n\r\n\t\tthis.ensureRunning()\r\n\t\treturn behavior\r\n\t}\r\n\r\n\tremove( condition ){\r\n\t\tlet behaviors = this.behaviors\r\n\t\tlet i = behaviors.length\r\n\t\twhile( i-- > 0 ){\r\n\t\t\tif( condition(behaviors[i]) ){\r\n\t\t\t\tbehaviors.splice( i, 1 )\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tremoveBehavior( behavior ) {\r\n\t\tthis.remove( target => target === behavior )\r\n\t}\r\n\r\n\tremoveTypeBehaviors( type ){\r\n\t\tthis.remove( target => target.type === type )\r\n\t}\r\n\t\r\n\tremoveTempBehaviors(){\r\n\t\tthis.remove( target => target.isTemp )\r\n\t}\r\n\t\r\n\tgetVelocity(){ \r\n\t\treturn { x: this.physicsObject.vx, y: this.physicsObject.vy }\r\n\t}\r\n\r\n\tensureRunning() {\r\n\t\tthis.isRunning || this.startRunning()\r\n\t}\r\n\r\n\tstartRunning() {\r\n\t\tthis.isRunning = true;\r\n\t\tthis.lastFrameTS = 0;\r\n\t\tthis.consecutiveFramesWithNoMovement = 0;\r\n\t\trequestAnimationFrame( () => this.doFrame( Date.now() ) )\r\n\t}\r\n\r\n\tstopRunning() {\r\n\t\tthis.removeTempBehaviors();\r\n\t\tthis.physicsObject = {vx: 0, vy: 0, mass: this.physicsObject.mass}\r\n\t\tthis.isRunning = false;\r\n\t}\r\n}\r\n\r\nexport default PhysicsAnimator","import { Animated, PanResponder } from 'react-native'\r\nimport injectDependencies from './InteractableView'\r\n\r\nlet Interactable = injectDependencies(Animated, PanResponder)\r\nexport default { View: Interactable }"],"names":["createArea","boundaries","minPoint","x","undefined","left","Infinity","y","top","maxPoint","right","bottom","createAreaFromRadius","radius","anchor","isPointInArea","area","findClosest","origin","points","minDistance","closestPoint","forEach","point","distance","_this","getDistance","relative","p","r","dx","Math","abs","dy","sqrt","getDelta","def","value","defaultValue","Animated","PanResponder","create","options","isTemp","x0","y0","priority","type","doFrame","deltaTime","state","coords","vx","vy","bounce","influence","target","setTranslationX","setTranslationY","friction","damping","Utils","influenceArea","pow","gravity","strength","falloff","dr","a","exp","mass","ax","ay","spring","tension","PhysicsAnimator","View","listener","debug","animatorListener","nofn","debugStart","debugEnd","frameTimeMillis","this","isRunning","lastFrameTS","animateFrameWithDeltaTime","onAnimationFrame","requestAnimationFrame","Date","now","behavior","debugB","debugInitialV","physicsObject","console","log","dvx","dvy","behaviors","hadMovement","getTranslation","_this2","Behaviors","animate","cfwnm","consecutiveFramesWithNoMovement","isDragging","stopRunning","onAnimatorPause","b","idx","length","splice","ensureRunning","condition","i","remove","startRunning","_this3","removeTempBehaviors","propBehaviors","frictionAreas","gravityPoints","springPoints","isWeb","document","props","initialPosition","animated","ValueXY","animator","createAnimator","insideAlertAreas","propAreas","alert","_pr","createPanResponder","setPropBehaviours","getAnimated","setValue","_startingValue","lastEnd","Component","style","withPosition","transform","translateX","translateY","concat","panHandlers","dragEnabled","React","children","_value","_offset","tx","animatedValueX","ty","animatedValueY","Animator","round","onStop","reportAlertEvent","setTranslation","onMoveShouldSetResponderCapture","onMoveShouldSetPanResponderCapture","onPanResponderGrant","e","startDrag","onPanResponderMove","evt","gesture","onDragging","onPanResponderRelease","endDrag","position","inside","onAlert","id","ev","offset","setOffset","dragBoundaries","onDrag","dragStartLocation","addTempDragBehavior","dragWithSpring","styles","body","userSelectCache","userSelect","pos","verticalOnly","dragBehavior","horizontalOnly","dragWithSprings","velocity","getVelocity","toss","dragToss","projectedCenter","snapPoint","snapPoints","targetSnapPointId","addTempSnapToPointBehavior","addTempBoundaries","flattenOffset","drag","addBehavior","onSnap","onSnapStart","index","indexOf","springOptions","prevProps","Object","keys","prop","_this4","removeTypeBehaviors","addTypeBehaviors","alertAreas","push","removeBehavior","oldBoundariesBehavior","_this5","PropTypes","array","bool","object","instanceOf","Value","func","onEnd","number"],"mappings":"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"}